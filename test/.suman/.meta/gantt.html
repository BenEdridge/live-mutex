<!DOCTYPE html>
<html>
<head>
  <title>Gantt Chart Example 1</title>
  <link type="text/css" href="http://mbostock.github.io/d3/style.css" rel="stylesheet"/>


  <style>
    html, body, #wrapper {
      width: 100%;
      height: 100%;
      margin: 0;
    }

    .chart {
      font-family: Arial, sans-serif;
      font-size: 12px;
    }

    .axis path, .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
    }

    .bar {
      fill: #33b5e5;
    }

    .bar-failed {
      fill: #CC0000;
    }

    .bar-running {
      fill: #669900;
    }

    .bar-succeeded {
      fill: #33b5e5;
    }

    .bar-killed {
      fill: #ffbb33;
    }

    #forkme_banner {
      display: block;
      position: absolute;
      top: 0;
      right: 10px;
      z-index: 10;
      padding: 10px 50px 10px 10px;
      color: #fff;
      background: url('http://dk8996.github.io/Gantt-Chart/images/blacktocat.png') #0090ff no-repeat 95% 50%;
      font-weight: 700;
      box-shadow: 0 0 10px rgba(0, 0, 0, .5);
      border-bottom-left-radius: 2px;
      border-bottom-right-radius: 2px;
      text-decoration: none;
    }
  </style>

</head>
<body>

<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="http://static.mentful.com/gantt-chart-d3v2.js"></script>


<script>

  let tasksOriginalExample = [
    {
      "startDate": new Date("Sun Dec 09 01:36:45 EST 2012"),
      "endDate": new Date("Sun Dec 09 02:36:45 EST 2012"),
      "taskName": "E Job",
      "status": "RUNNING"
    },
    {
      "startDate": new Date("Sun Dec 09 04:56:32 EST 2012"),
      "endDate": new Date("Sun Dec 09 06:35:47 EST 2012"),
      "taskName": "A Job",
      "status": "RUNNING"
    },
    {
      "startDate": new Date("Sun Dec 09 06:29:53 EST 2012"),
      "endDate": new Date("Sun Dec 09 06:34:04 EST 2012"),
      "taskName": "D Job",
      "status": "RUNNING"
    }
  ];

  let tasksRaw = JSON.parse('[{"startDate":1552779464408,"endDate":1552779477981,"transformStartDate":1552779464006,"transformEndDate":1552779464385,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/alphabet.test.ts","status":"SUCCEEDED"},{"startDate":1552779464412,"endDate":1552779527437,"transformStartDate":1552779464013,"transformEndDate":1552779464386,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/alphabet2.test.ts","status":"FAILED"},{"startDate":1552779468523,"endDate":1552779530146,"transformStartDate":1552779464011,"transformEndDate":1552779468517,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/alphabet3.test.ts","status":"FAILED"},{"startDate":1552779464555,"endDate":1552779477455,"transformStartDate":1552779464399,"transformEndDate":1552779464549,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/errors.test.ts","status":"SUCCEEDED"},{"startDate":1552779464562,"endDate":1552779466944,"transformStartDate":1552779464412,"transformEndDate":1552779464555,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/four-promise.test.ts","status":"SUCCEEDED"},{"startDate":1552779464730,"endDate":1552779473847,"transformStartDate":1552779464550,"transformEndDate":1552779464724,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/general.test.ts","status":"FAILED"},{"startDate":1552779464740,"endDate":1552779470387,"transformStartDate":1552779464557,"transformEndDate":1552779464732,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/one.test.ts","status":"SUCCEEDED"},{"startDate":1552779468628,"endDate":1552779472815,"transformStartDate":1552779464725,"transformEndDate":1552779468622,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/one.unix.domain.sockets.test.ts","status":"SUCCEEDED"},{"startDate":1552779469314,"endDate":1552779478848,"transformStartDate":1552779464734,"transformEndDate":1552779468732,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/promises.test.ts","status":"FAILED"},{"startDate":1552779468702,"endDate":1552779469311,"transformStartDate":1552779468518,"transformEndDate":1552779468690,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/rw-lock.test.ts","status":"SUCCEEDED"},{"startDate":1552779470390,"endDate":1552779479854,"transformStartDate":1552779468623,"transformEndDate":1552779468824,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/semaphore.test.ts","status":"FAILED"},{"startDate":1552779472818,"endDate":1552779482269,"transformStartDate":1552779468693,"transformEndDate":1552779468873,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/ts.test.ts","status":"FAILED"},{"startDate":1552779473850,"endDate":1552779537452,"transformStartDate":1552779468732,"transformEndDate":1552779468878,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/two.test.ts","status":"FAILED"},{"startDate":1552779477458,"endDate":1552779486939,"transformStartDate":1552779468824,"transformEndDate":1552779468964,"taskName":"/Users/Olegzandr/WebstormProjects/oresoftware/live-mutex/test/@src/z.test.ts","status":"FAILED"}]');

  let tasks = [];

  tasksRaw.forEach(function (t) {

    // we have two separate tasks per item, one for transform, one for run
    if (t.transformStartDate && t.transformEndDate) {
      tasks.push({
        taskName: t.taskName,
        startDate: new Date(t.transformStartDate),
        endDate: new Date(t.transformEndDate),
        status: 'SUCCEEDED'
      });
    }

    if (t.startDate && t.endDate) {
      tasks.push({
        taskName: t.taskName,
        startDate: new Date(t.startDate),
        endDate: new Date(t.endDate),
        status: t.status
      });
    }
  });

  let taskStatus = {
    "SUCCEEDED": "bar",
    "FAILED": "bar-failed",
    "RUNNING": "bar-running",
    "KILLED": "bar-killed"
  };


  let taskNames = tasks.map(function (t) {
    return t.taskName;
  });

  tasks.sort(function (a, b) {
    return a.endDate - b.endDate;
  });


  tasks.sort(function (a, b) {
    return a.startDate - b.startDate;
  });

  let format = "%H:%M:%S";
  let gantt = d3.gantt().taskTypes(taskNames).taskStatus(taskStatus).tickFormat(format);

  gantt(tasks);

</script>


</body>
</html>
